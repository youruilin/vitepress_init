# çº¯æ‰‹æ“å›¾ç‰‡å±•ç¤ºç»„ä»¶

## è½®æ’­ç»„ä»¶

uniapp çš„å†…ç½®ç»„ä»¶ swiper ï¼Œè‡ªå¸¦çš„æ»‘åŠ¨åœ†ç‚¹ä¸æ”¯æŒæ ·å¼è®¾ç½®å’Œç‚¹å‡»åˆ‡æ¢ itemï¼Œå·²ä¸‹æ˜¯è¯¦ç»†å®ç°ä»£ç ï¼š

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

```
<script setup lang="ts">
import { ref } from 'vue'

const indicatorDots = ref(false) // éšè—åŸç”Ÿçš„
const autoplay = ref(true)
const interval = ref(4000)
const duration = ref(500)

const current = ref(0)

const change = (e: any) => {
  current.value = e.detail.current
}

const clickDot = (index: number) => {
  current.value = index
}
</script>

<template>
  <view class="card-inner">
    <view class="img-head">
      <image
        class="head-left"
        src="http://lychee.iooio.cn:9527/uploads/original/4d/0d/2bdbd7bd407907f53282aeff8083.png"
      ></image>

      <view class="head-right">
        <swiper
          class="head-swiper"
          circular
          :indicator-dots="false"
          :current="current"
          @change="change"
          :autoplay="autoplay"
          :interval="interval"
          :duration="duration"
        >
          <swiper-item v-for="(item, index) in 3" :key="index">
            <image
              class="img-swiper"
              mode="aspectFill"
              src="http://lychee.iooio.cn:9527/uploads/original/4d/0d/2bdbd7bd407907f53282aeff8083.png"
            ></image>
          </swiper-item>
        </swiper>

        <!-- è‡ªå®šä¹‰æŒ‡ç¤ºç‚¹ -->
        <view class="dots">
          <view
            v-for="(dot, index) in 3"
            :key="index"
            class="dot"
            :class="{ active: current === index }"
            @click="clickDot(index)"
          ></view>
        </view>
      </view>
    </view>

    <view class="card-dec">æ–‡å­—æè¿°</view>
  </view>
</template>

<style lang="scss" scoped>
.img-head {
  padding-top: 10rpx;
  display: flex;
  justify-content: space-between;

  .head-left {
    width: 250rpx;
    height: auto;
    margin-right: 16rpx;
    border-radius: 12rpx;
    box-sizing: border-box;
  }

  .head-right {
    width: 100%;
    position: relative;
    height: 250rpx;
    overflow: hidden;
    border-radius: 12rpx;

    .img-swiper {
      width: 100%;
      height: 250rpx;
      display: block;
    }

    .dots {
      position: absolute;
      bottom: 12rpx;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 12rpx;

      .dot {
        width: 14rpx;
        height: 14rpx;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.4);
      }

      .active {
        background: rgba(255, 255, 255, 1);
      }
    }
  }
}

.card-dec {
  margin-top: 20rpx;
  color: #333;
  font-size: 28rpx;
}
</style>
```

å…¶ä¸­çš„æŒ‡ç¤ºç‚¹ã€å½“ç„¶ï¼Œå¯¹æˆ‘æ¥è¯´ä¹Ÿæ˜¯çŸ¥è¯†ç‚¹ï¼š

1. UniApp éµå¾ªå¾®ä¿¡å°ç¨‹åºçš„äº‹ä»¶è§„èŒƒï¼Œå…¶ä¸­ `detail` ç”¨äºä¼ é€’ç»„ä»¶è‡ªå®šä¹‰æ•°æ®ï¼š

```
<!-- ç»„ä»¶è§¦å‘äº‹ä»¶æ—¶ -->
<swiper @change="change">
  <!-- swiper ç»„ä»¶åœ¨å˜åŒ–æ—¶ä¼šè§¦å‘äº‹ä»¶ï¼Œå¹¶é€šè¿‡ detail ä¼ é€’å½“å‰é¡µç  -->
</swiper>
```



2. **è‡ªå®šä¹‰äº‹ä»¶æ•°æ®**

å½“ç»„ä»¶è§¦å‘äº‹ä»¶æ—¶ï¼Œç›¸å…³çš„æ•°æ®éƒ½æ”¾åœ¨ `detail` ä¸­ï¼š

```
// swiper ç»„ä»¶å˜åŒ–æ—¶
const change = (e) => {
  console.log(e.detail.current) // å½“å‰é¡µç 
}

// picker ç»„ä»¶é€‰æ‹©æ—¶
const pickerChange = (e) => {
  console.log(e.detail.value)   // é€‰ä¸­çš„å€¼
}

// æŒ‰é’®ç‚¹å‡»æ—¶
const buttonClick = (e) => {
  console.log(e.detail)         // å¯èƒ½åŒ…å«å…¶ä»–ä¿¡æ¯
}
```



3. **ç»Ÿä¸€çš„æ•°æ®é€šé“**

`detail` æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„å±æ€§æ¥ä¼ é€’äº‹ä»¶ç›¸å…³æ•°æ®ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨äº‹ä»¶å¯¹è±¡ä¸Šæ·»åŠ å„ç§å±æ€§ã€‚

å®é™…ç¤ºä¾‹

```
<template>
  <!-- å„ç§ç»„ä»¶çš„äº‹ä»¶éƒ½ä½¿ç”¨ detail -->
  <swiper @change="onSwiperChange">
  <picker @change="onPickerChange">
  <button @click="onButtonClick">
  <input @input="onInput">
</template>

<script>
export default {
  methods: {
    onSwiperChange(e) {
      console.log(e.detail.current) // è½®æ’­å›¾å½“å‰ç´¢å¼•
    },
    onPickerChange(e) {
      console.log(e.detail.value)   // é€‰æ‹©å™¨é€‰ä¸­çš„å€¼
    },
    onButtonClick(e) {
      console.log(e.detail)         // å¯èƒ½åŒ…å«å…¶ä»–ä¿¡æ¯
    },
    onInput(e) {
      console.log(e.detail.value)   // è¾“å…¥æ¡†çš„å€¼
    }
  }
}
</script>
```



è®¾è®¡åŸå› 

1. **ä¸€è‡´æ€§**ï¼šæ‰€æœ‰ç»„ä»¶çš„äº‹ä»¶æ•°æ®éƒ½é€šè¿‡ `detail` ä¼ é€’
2. **æ‰©å±•æ€§**ï¼šå¯ä»¥åœ¨ `detail` ä¸­è‡ªç”±æ·»åŠ æ•°æ®è€Œä¸æ±¡æŸ“äº‹ä»¶å¯¹è±¡
3. **å…¼å®¹æ€§**ï¼šä¸å¾®ä¿¡å°ç¨‹åºã€æ”¯ä»˜å®å°ç¨‹åºç­‰ä¿æŒä¸€è‡´æ€§

æ‰€ä»¥ `e.detail` æ˜¯ UniApp/å°ç¨‹åºç”Ÿæ€ä¸­çš„**æ ‡å‡†åšæ³•**ï¼Œä¸æ˜¯ JavaScript åŸç”Ÿäº‹ä»¶çš„å¯¹è±¡ç»“æ„ã€‚

:::



## åŸç”Ÿuni-swiper-dotç»„ä»¶çš„ä½¿ç”¨

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

ç›¸æ¯”ä¹‹ä¸‹ - è¿™ä¸ªæ•ˆæœæ›´ä¸æ»‘ï¼ˆéœ€è¦ä¾èµ–å…¶ä»–uni-ç»„ä»¶ï¼‰ï¼Œå› æ­¤ï¼Œå¿…é¡»ä½¿ç”¨ hbuild å·¥å…·æ•´ä¸ªå®‰è£…è¿™ä¸ªæ’ä»¶åŒ…ï¼

å…¶å®ï¼Œå‚ç…§è¿™ä¸ªçº¯æ‰‹å†™ä¸€ä¸ªåœ†ç‚¹çš„ï¼Œä¹Ÿä¸éš¾ï¼Œè‡ªå·±æ‰‹å†™å¯ä»¥é¿å…ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚ï¼ˆå¯èƒ½ï¼‰æŒ‡ç¤ºç‚¹çš„å®šä½é—®é¢˜ï¼Œå®˜æ–¹å¯èƒ½ä¾æ®å›¾ç‰‡ä¸‹è¾¹è·è¿›è¡Œç›¸å¯¹å®šä½ï¼Œå¯¼è‡´ä¸å¤Ÿç»†è‡´çš„ç”¨æˆ·ä½“éªŒï¼Œå› ä¸ºå›¾ç‰‡æ¯”ä¾‹ä¼šæœ‰äº›å·®å¼‚ï¼Œæ²ƒæ©æ‰‹å†™çš„è¯ï¼Œå¯ä»¥å†™å®šï¼Œç›´æ¥ç›¸å¯¹çˆ¶ç›’å­è¿›è¡Œå®šä½ï¼

æ ‡ç­¾ç»“æ„ï¼š

```html
<view class="custom-swiper-container">
  <uni-swiper-dot
    :info="info"
    :current="current"
    field="content"
    mode="default"
    @clickItem="clickItem"
  >
    <swiper
      class="swiper-box"
      :current="current"
      @change="change"
      :autoplay="autoplay"
      :interval="interval"
      :duration="duration"
      circular
    >
      <swiper-item
        v-for="(item, index) in info"
        :key="index"
      >
        <view
          class="swiper-item"
          :class="item.colorClass"
        >
          <image
            :src="item.url"
            mode="aspectFill"
            class="swiper-image"
          />
          <text class="swiper-text">{{ item.content }}</text>
        </view>
      </swiper-item>
    </swiper>
  </uni-swiper-dot>
</view>
```

jsé€»è¾‘ï¼š

```js
<script setup lang="ts">
import { ref } from 'vue'

const indicatorDots = ref<boolean>(true)
const autoplay = ref<boolean>(true)
const interval = ref<number>(4000)
const duration = ref<number>(500)

// æ·»åŠ  current å“åº”å¼å˜é‡
const current = ref<number>(0)

const info = [
  {
    colorClass: 'uni-bg-red',
    url: 'https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/shuijiao.jpg',
    content: 'å†…å®¹ A',
  },
  {
    colorClass: 'uni-bg-green',
    url: 'https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/shuijiao.jpg',
    content: 'å†…å®¹ B',
  },
  {
    colorClass: 'uni-bg-blue',
    url: 'https://qiniu-web-assets.dcloud.net.cn/unidoc/zh/shuijiao.jpg',
    content: 'å†…å®¹ C',
  },
]

// æ·»åŠ  change æ–¹æ³•
const change = (e: { detail: { current: number } }) => {
  current.value = e.detail.current
  console.log('swiper åˆ‡æ¢:', current.value)
}

// æ·»åŠ  clickItem æ–¹æ³•
const clickItem = (index: number) => {
  current.value = index
  console.log('ç‚¹å‡»æŒ‡ç¤ºç‚¹:', index)
}
</script>
```

cssæ ·å¼ï¼š

```css
.custom-swiper-container {
  margin-top: 40rpx;
  position: relative;

  .swiper-box {
    height: 400rpx;
    border-radius: 12rpx;
    overflow: hidden;
  }

  .swiper-item {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
  }

  .swiper-image {
    width: 100%;
    height: 100%;
  }

  .swiper-text {
    position: absolute;
    bottom: 30rpx;
    left: 30rpx;
    color: white;
    font-size: 36rpx;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
  }
}

// èƒŒæ™¯è‰²ç±»
.uni-bg-red {
  background-color: #ff5a5f;
}

.uni-bg-green {
  background-color: #09bb07;
}

.uni-bg-blue {
  background-color: #007aff;
}
```



:::



# å¯¼èˆªæ ä¸“å±å‘ä½

## é¡µé¢å¯¼èˆªæ 

ç›´æ¥å†™é¡µé¢å¯¼èˆªæ æ˜¯ä¸‡ä¸‡ä¸èƒ½çš„ï¼ŒåŠæ—¶ç¼–å†™äº†å¯¼èˆªæ ç»„ä»¶ï¼Œä¹Ÿéœ€è¦å¯¹å…¶ä¸­çš„å®šä½åšç‰¹æ®Šçš„å®‰æ’ï¼

é¦–å…ˆï¼Œæ„é€ ä¸€ä¸ªå¤„ç†é¡µé¢æ»šåŠ¨çš„é€»è¾‘ï¼š

::: code-group

```js
// å¤„ç†é¡µé¢æ»šåŠ¨
const scrollTop = ref(0)

// åœ¨é¡µé¢ä¸­ç›´æ¥ä½¿ç”¨onPageScrollç”Ÿå‘½å‘¨æœŸ
onPageScroll(e => {
  scrollTop.value = e.scrollTop
  console.log('è·ç¦»é¡¶éƒ¨:', scrollTop.value, 'px /', scrollTop.value / 2 + 'rpx')
}) 

// å½“å‰ï¼Œè°ƒè¯•ä¿¡æ¯ç”Ÿæ•ˆäº†ï¼Œä½†æ˜¯è¿˜éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œæˆ‘ä»¬éœ€è¦å®ƒè¿”å›100ä»¥å†…çš„æ•´æ•°
// å…¶ä½™æ»šåŠ¨çš„æ•°å€¼ä¸éœ€è¦è¿”å›ï¼Œå½“æ•°å€¼å¤§äº100æ—¶ï¼Œä»è¿”å›100ï¼
```

```ts
// å¤„ç†é¡µé¢æ»šåŠ¨
const navTitlePadding = ref(250)
const scrollTop = ref(0)
const normalizedScrollTop = ref(0) // æ ‡å‡†åŒ–åçš„æ»šåŠ¨å€¼ // [!code++]

// åœ¨é¡µé¢ä¸­ç›´æ¥ä½¿ç”¨onPageScrollç”Ÿå‘½å‘¨æœŸ
onPageScroll(e => {
  scrollTop.value = e.scrollTop
  const scrollTopRpx = e.scrollTop / 2
  
  // æ ‡å‡†åŒ–æ»šåŠ¨å€¼ï¼šé™åˆ¶åœ¨0-100ä¹‹é—´ï¼Œå–æ•´æ•° // [!code++]
  normalizedScrollTop.value = Math.min(100, Math.max(0, Math.round(scrollTopRpx))) // [!code++]
  
  console.log('ğŸ“Š æ»šåŠ¨ä¿¡æ¯:', {
    'åŸå§‹å€¼(px)': e.scrollTop,
    'è½¬æ¢å€¼(rpx)': scrollTopRpx.toFixed(1), // [!code++]
    'æ ‡å‡†åŒ–å€¼': normalizedScrollTop.value // [!code++]
  })
  
  // æ›´æ–°å¯¼èˆªæ å†…è¾¹è· // [!code++]
  updateNavPadding(normalizedScrollTop.value) // [!code++]
})

// æ›´æ–°å¯¼èˆªæ å†…è¾¹è·çš„å‡½æ•°
const updateNavPadding = (scrollValue: number) => {
  if (scrollValue <= 100) {
    const progress = scrollValue / 100
    navTitlePadding.value = 250 - (200 * progress)
  } else {
    navTitlePadding.value = 50
  }
}
```

```ts [ç®€åŒ–ç‰ˆæœ¬]
// å¤„ç†é¡µé¢æ»šåŠ¨
const navTitlePadding = ref(250) // 250 æ˜¯æ ‡ç­¾ä½ç½®çš„å®é™…åŸå§‹å€¼ // [!code--]
const normalizedScrollTop = ref(0) // æ ‡å‡†åŒ–åçš„æ»šåŠ¨å€¼(0-100)

// åœ¨é¡µé¢ä¸­ç›´æ¥ä½¿ç”¨onPageScrollç”Ÿå‘½å‘¨æœŸ
onPageScroll(e => {
  const scrollTopRpx = e.scrollTop / 2

  normalizedScrollTop.value = Math.min(100, Math.round(scrollTopRpx))

  console.log('ğŸ¯ æ ‡å‡†åŒ–æ»šåŠ¨å€¼:', normalizedScrollTop.value)

  // ä½¿ç”¨éçº¿æ€§å‡½æ•°æé«˜çµæ•åº¦ // [!code--]
  const progress = Math.pow(normalizedScrollTop.value / 100, 0.5) // å¹³æ–¹æ ¹å‡½æ•°ï¼Œå‰æœŸå˜åŒ–æ›´å¿« // [!code--]
  navTitlePadding.value = 250 - 200 * progress // [!code--]
})
```

:::

**å…³é”®ç‚¹è¯´æ˜ï¼š**

1. **`Math.round()`** - å››èˆäº”å…¥å–æ•´æ•°
2. **`Math.min(100, ...)`** - é™åˆ¶æœ€å¤§å€¼ä¸è¶…è¿‡100
3. **`Math.max(0, ...)`** - ç¡®ä¿æœ€å°å€¼ä¸å°äº0ï¼ˆè™½ç„¶æ»šåŠ¨å€¼ä¸ä¼šä¸ºè´Ÿï¼‰
4. **æ ‡å‡†åŒ–èŒƒå›´** - å§‹ç»ˆè¿”å›0-100çš„æ•´æ•°

ç„¶åï¼Œè°ƒç”¨ä½ç½®ï¼š

```html
<text
  class="nav-title"
  :style="{
    paddingLeft: Math.max(10, 250 - 500 * (normalizedScrollTop / 100)) + 'rpx',
    transition: 'padding-left 0.3s ease',
  }"
>
  åœ°å—è¯¦æƒ…
</text>
```

