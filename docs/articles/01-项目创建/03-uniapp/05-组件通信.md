# ç»„ä»¶é€šä¿¡

## 1. Props / Emitsï¼šæœ€åŸºç¡€çš„çˆ¶å­ä¼ å€¼æœ€åŸºç¡€çš„çˆ¶å­ä¼ å€¼

### Propsï¼šçˆ¶ä¼ å­çš„å•å‘æ•°æ®æµ

::: details

è¿™æ˜¯ Vue çš„å®˜æ–¹æ¨èé€šä¿¡æ–¹å¼ï¼Œéµå¾ª**å•å‘æ•°æ®æµ**åŸåˆ™ï¼Œæ•°æ®åªèƒ½ä»ä¸Šå¾€ä¸‹æµï¼Œäº‹ä»¶ä»ä¸‹å¾€ä¸Šä¼ ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šå½“ä½ éœ€è¦æŠŠé…ç½®ã€ç”¨æˆ·ä¿¡æ¯ã€çŠ¶æ€ç­‰æ•°æ®ä»çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶æ—¶ã€‚

```vue
<!-- çˆ¶ç»„ä»¶è°ƒç”¨ -->
<script>
	// çŸ­è¯„æ•°æ®
import type { CommentData } from '@/types/comment'

// å‡†å¤‡è¯„è®ºæ•°æ® - ç°åœ¨ä½œä¸ºä¸€ä¸ªå¯¹è±¡ä¼ é€’
const commentData = ref<CommentData>({
  list: [
    {
      id: 1,
      avatar: 'https://picsum.photos/id/100/300/240',
      username: 'ç”¨æˆ·å1',
      rating: 4.5,
      date: '2025-12-20',
      location: 'å±±ä¸œ',
      content: 'éƒ‘å•958å¯ä»¥é€‚åº”è¿‘äº›å¹´çš„æç«¯æ°”å€™ï¼Œå»å¹´ç§äº†900äº©ï¼Œä»Šå¹´1200äº©ï¼',
      likes: 3051,
    },
    {
      id: 2,
      avatar: 'https://picsum.photos/id/101/300/240',
      username: 'ç”¨æˆ·å2',
      rating: 5,
      date: '2025-12-21',
      location: 'æ²³å—',
      content: 'å§œè¿˜æ˜¯è€çš„è¾£ï¼Œéƒ‘å•958å¯ä»¥é€‚åº”è¿‘äº›å¹´çš„æç«¯æ°”å€™ï¼Œå»å¹´ç§äº†900äº©ï¼Œä»Šå¹´1200äº©ï¼',
      likes: 2100,
    },
    {
      id: 3,
      avatar: 'https://picsum.photos/id/102/300/240',
      username: 'ç”¨æˆ·å3',
      rating: 3.5,
      date: '2025-12-22',
      location: 'æ²³åŒ—',
      content: 'è¿™ä¸ªå“ç§ç¡®å®ä¸é”™ï¼ŒæŠ—ç—…æ€§å¼ºï¼Œäº§é‡ç¨³å®š',
      likes: 1200,
    },
    {
      id: 4,
      avatar: 'https://picsum.photos/id/103/300/240',
      username: 'ç”¨æˆ·å4',
      rating: 4,
      date: '2025-12-23',
      location: 'æ±Ÿè‹',
      content: 'è¿ç»­ä¸‰å¹´ç§æ¤ï¼Œæ•ˆæœä¸€ç›´å¾ˆå¥½',
      likes: 980,
    },
  ],
  total: 102, // æœåŠ¡å™¨è¿”å›çš„å®é™…æ€»æ•°
})
</script>

<template>
	<DuanPing :comment-data="commentData"></DuanPing>
</template>
```

```vue
<!-- å­ç»„ä»¶ -->
<script>
import type { CommentData, CommentItem } from '@/types/comment'
  
// ç›´æ¥æ¥æ”¶-å­—ç¬¦ä¸²æ•°ç»„å½¢å¼ï¼ˆæœ€ç®€å•ï¼‰
defineProps(['commentData'])
  
// å¸¦ç±»å‹éªŒè¯
defineProps({
  title: String,
  count: {
    type: Number,
    default: 0,
    required: true
  },
  isActive: {
    type: Boolean,
    default: false
  },
  user: {
    type: Object,
    default: () => ({})
  }
})
  
// å®˜æ–¹æ¨è
// TypeScript å®šä¹‰ props - ä½¿ç”¨æ˜ç¡®çš„æ¥å£å®šä¹‰é¿å…ç±»å‹é—®é¢˜
interface Props {
  commentData?: CommentData
  title?: string
  iconType?: string
  showViewAll?: boolean
  maxDisplay?: number
}

const props = withDefaults(defineProps<Props>(), {
  commentData: undefined, // ä¸æä¾›é»˜è®¤å€¼ï¼Œåœ¨ computed ä¸­å¤„ç†
  title: 'çŸ­è¯„',
  iconType: 'chat',
  showViewAll: true,
  maxDisplay: undefined,
})
</script>
```

:::

::: details props ä¸“å±å‘ä½

ä¸Šé¢çš„ç±»å‹å£°æ˜æ–‡ä»¶ä¸­ï¼š

```ts
// è¯„è®ºé¡¹æ¥å£
export interface CommentItem {
  id: number | string
  avatar: string
  username: string
  rating: number
  date: string
  location: string
  content: string
  likes: number
}

// è¯„è®ºæ•°æ®æ¥å£ï¼ˆåŒ…å«è¯„è®ºåˆ—è¡¨å’Œæ€»æ•°ï¼‰
export interface CommentData {
  list: CommentItem[]
  total: number
}

// ç»„ä»¶ Props æ¥å£
export interface CommentCardProps {
  commentData?: CommentData
  title?: string
  iconType?: string
  showViewAll?: boolean
  maxDisplay?: number
}

```

å…¶ä¸­ï¼Œç»å¯¹ä¸å¯ä»¥æœ‰çš„æ˜¯ï¼š

```ts
// ç»„ä»¶ Props æ¥å£
export interface CommentCardProps {
  commentData?: CommentData
  title?: string
  iconType?: string
  showViewAll?: boolean
  maxDisplay?: number
}
```

å› ä¸ºï¼Œinterface props çš„å£°æ˜ï¼Œå¿…é¡»åœ¨ç»„ä»¶å†…éƒ¨ï¼Œè€Œä¸å¯ä»¥ç‹¬ç«‹äºç±»å‹æ–‡ä»¶ä¸­å¼•å…¥ä½¿ç”¨ï¼å¦åˆ™propsä¸ºundefinedï¼

ä¸ºæ­¤æŠ˜è…¾äº†ä¿©å°æ—¶ï¼Œæ™•äº†ï¼

:::

### Emitsï¼šå­ä¼ çˆ¶çš„äº‹ä»¶æœºåˆ¶

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

**é€‚ç”¨åœºæ™¯**ï¼šå­ç»„ä»¶éœ€è¦é€šçŸ¥çˆ¶ç»„ä»¶æœ‰äº‹å‘ç”Ÿï¼Œæ¯”å¦‚è¡¨å•æäº¤ã€æŒ‰é’®ç‚¹å‡»ã€è¾“å…¥å˜åŒ–ç­‰ã€‚

```vue
<!-- å­ç»„ä»¶ ChildComponent.vue -->
<script>
//å®šä¹‰å¯è§¦å‘çš„äº‹ä»¶
interface Emits {
  (e: 'update:modelValue', value: boolean): void
  (e: 'open'): void
  (e: 'close'): void
  (e: 'toggle', value: boolean): void
  (e: 'click-overlay'): void
  (e: 'click-popup'): void
  // === æ–°å¢ï¼šåˆå§‹é«˜åº¦å½’ä½äº‹ä»¶ ===
  (e: 'initial-height-reset'): void
}

const emit = defineEmits<Emits>()

// åˆ‡æ¢å¼¹å‡ºå±‚çŠ¶æ€
const togglePopup = (show?: boolean) => {
  if (isAnimating.value) return

  const targetState = show !== undefined ? show : !isActive.value

  isAnimating.value = true
  isActive.value = targetState

  // === é‡ç½®æ‹–æ‹½çŠ¶æ€ ===
  if (targetState) {
    resetDragState()
  }

  // === æ–°å¢ï¼šå¼¹å‡ºå±‚åˆ‡æ¢æ—¶é‡ç½®åˆå§‹é«˜åº¦ ===
  // å¦‚æœå¼¹å‡ºå±‚ä»æœªæ¿€æ´»å˜ä¸ºæ¿€æ´»ï¼ˆå³å±•å¼€ï¼‰ï¼Œé‡ç½®åˆå§‹é«˜åº¦
  if (targetState && isUsingInitialHeight.value) {
    resetInitialHeight()
  }

  // ä¼ é€’ç»™çˆ¶ç»„ä»¶
  emit('update:modelValue', targetState)
  emit('toggle', targetState)

  if (targetState) {
    emit('open')
    // å±•å¼€åæ»šåŠ¨åˆ°é¡¶éƒ¨
    setTimeout(() => {
      if (scrollViewRef.value) {
        scrollViewRef.value.scrollTo({
          top: 0,
          duration: 0,
        })
      }
    }, 50)
  } else {
    emit('close')
  }

  // åŠ¨ç”»ç»“æŸåé‡ç½®çŠ¶æ€
  setTimeout(() => {
    isAnimating.value = false
  }, 300)
}
</script>
```

```vue
<!-- çˆ¶ç»„ä»¶ Parent.vue -->
<tempalate>
	<!-- å¼¹å‡ºå±‚ç»„ä»¶ -->
    <BottomPopup
      ref="popupRef"
      v-model="popupVisible"
      :default-height="80"
      :initial-height="100"
      active-height="85vh"
      @open="handleOpen"  <!-- è¿™é‡Œï¼Œä½¿ç”¨ @ ç¬¦æ¥æ”¶å­ç»„ä»¶çš„ emit -->
      @close="handleClose"  <!-- å¹¶ä¸”æŒ‡å‘jsé€»è¾‘ä¸­çš„å…·ä½“é€»è¾‘ -->
    >
      <!-- ä½¿ç”¨æ’æ§½ä¼ å…¥è‡ªå®šä¹‰å†…å®¹ -->
      <view class="popup-content">
        <view class="section">
          <text class="title">æ ‡é¢˜ä¸€</text>
          <text class="desc">è¿™é‡Œæ˜¯å†…å®¹æè¿°...</text>
        </view>

        <view class="section">
          <text class="title">æ ‡é¢˜äºŒ</text>
          <text class="desc">æ›´å¤šå†…å®¹...</text>
        </view>

        <!-- åˆ—è¡¨å†…å®¹ -->
        <view
          v-for="item in list"
          :key="item.id"
          class="list-item"
          @tap="handleItemClick(item)"
        >
          <text>{{ item.name }}</text>
        </view>
      </view>
    </BottomPopup>
</tempalate>
```

:::

å¤šç»„ä»¶é€šä¿¡ï¼ˆVue 3.3+ æ¨èï¼‰

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

```vue
<template>
  <!-- ä½¿ç”¨ v-model è¯­æ³•ç³– -->
  <CustomInput v-model="username" />
  
  <!-- ç­‰ä»·äº -->
  <CustomInput 
    :modelValue="username"
    @update:modelValue="newValue => username = newValue"
  />
</template>
```

ä¹Ÿå°±æ˜¯è¯´ï¼š

```vue
<BottomPopup
  ref="popupRef"
  v-model="popupVisible"
>
  <!-- æ’æ§½å†…å®¹éƒ¨åˆ† -->
</BottomPopup>

<!-- ç­‰ä»·äº -->

<BottomPopup
  ref="popupRef"
  :modelValue="popipVisible" 
  @uodate:modelValue="newValue => popuopVisible = newValue"
>
  <!-- æ’æ§½å†…å®¹éƒ¨åˆ† -->
</BottomPopup>

```

:::



## 2. v-modelï¼šåŒå‘ç»‘å®šçš„è¯­æ³•ç³–

### v-model åœ¨ Vue3 ä¸­å˜å¾—æ›´åŠ å¼ºå¤§ï¼Œæ”¯æŒå¤šä¸ª v-model ç»‘å®š

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

Vue 2 ä¸­çš„ v-model

```vue
<!-- çˆ¶ç»„ä»¶ -->
<ChildComponent v-model="value" />

<!-- ç­‰ä»·äº -->
<ChildComponent 
  :value="value"
  @input="value = $event"
/>
```

Vue 3 ä¸­çš„é»˜è®¤ v-model

```vue
<!-- çˆ¶ç»„ä»¶ -->
<ChildComponent v-model="value" />

<!-- ç­‰ä»·äº -->
<ChildComponent 
  :modelValue="value"
  @update:modelValue="newValue => value = newValue"
/>
```

ä½† Vue 3 çš„ v-model å·²ç»è¶…è¶Šäº†"ç®€å•è¯­æ³•ç³–"ï¼š

ç‰¹æ€§ä¸€ï¼šå¤šä¸ª v-model ç»‘å®š

```vue
<!-- çˆ¶ç»„ä»¶ï¼šå¯ä»¥ç»‘å®šå¤šä¸ª v-model -->
<UserForm
  v-model:name="userName"
  v-model:email="userEmail"
  v-model:age="userAge"
/>

<!-- ç­‰ä»·äº -->
<UserForm
  :name="userName"
  @update:name="userName = $event"
  :email="userEmail"
  @update:email="userEmail = $event"
  :age="userAge"
  @update:age="userAge = $event"
/>


<!-- å­ç»„ä»¶ UserForm.vue -->
<template>
  <input :value="name" @input="updateName($event.target.value)">
  <input :value="email" @input="$emit('update:email', $event.target.value)">
  <input type="number" :value="age" @input="updateAge($event.target.value)">
</template>

<script setup lang="ts">
// å®šä¹‰ Props æ¥å£
interface Props {
  name: string
  email: string
  age: number
}

// å®šä¹‰ Emits ç±»å‹ -  ä¼ ç»Ÿæ–¹å¼ï¼ˆVue 3.4 ä¹‹å‰ï¼‰ï¼šéœ€è¦æ‰‹åŠ¨å£°æ˜ props å’Œ emits
const emit = defineEmits<{
  (e: 'update:name', value: string): void
  (e: 'update:email', value: string): void
  (e: 'update:age', value: number): void
}>()

// æ¥æ”¶ Props -  ä¼ ç»Ÿæ–¹å¼ï¼ˆVue 3.4 ä¹‹å‰ï¼‰ï¼š éœ€è¦æ‰‹åŠ¨å£°æ˜ props å’Œ emits
const props = defineProps<Props>()

// å¤„ç†æ–¹æ³•
const updateName = (value: string) => {
  emit('update:name', value.trim())
}

const updateAge = (value: string) => {
  const age = parseInt(value)
  if (!isNaN(age)) {
    emit('update:age', Math.max(0, age)) // ç¡®ä¿å¹´é¾„ä¸ä¸ºè´Ÿæ•°
  }
}
</script>
```

`v-model`çš„æ ¸å¿ƒä¼˜åŠ¿ï¼š

- è¯­æ³•ç®€æ´ï¼Œå‡å°‘æ ·æ¿ä»£ç 
- ç¬¦åˆåŒå‘ç»‘å®šçš„ç›´è§‰
- æ”¯æŒå¤šä¸ªv-modelç»‘å®š
- ç±»å‹å®‰å…¨ï¼ˆé…åˆTypeScriptï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šè‡ªå®šä¹‰è¡¨å•æ§ä»¶ï¼ˆå¦‚æ—¥æœŸé€‰æ‹©å™¨ã€å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼‰éœ€è¦åŒå‘ç»‘å®šã€‚

:::

Vue 3.4+ï¼šä½¿ç”¨ `defineModel`ï¼ˆä¸éœ€è¦æ‰‹åŠ¨å£°æ˜ï¼‰

::: details Vue 3.4+ æ¨è

âœ… **æ–°çš„ç®€æ´æ–¹å¼ï¼ˆVue 3.4+ æ¨èï¼‰ï¼š**

```vue
<!-- ChildComponent.vue -->
<script setup>
// ä¸€è¡Œä»£ç æå®šï¼ä¸éœ€è¦ defineProps å’Œ defineEmits
const modelValue = defineModel()
// æˆ–è€…å¸¦å‚æ•°çš„
const title = defineModel('title')
const count = defineModel('count', { type: Number, default: 0 })
</script>

<template>
  <!-- å¯ä»¥ç›´æ¥ç”¨ v-model ç»‘å®š -->
  <input v-model="modelValue">
  <input v-model="title">
  <input v-model="count" type="number">
</template>
```

è¿™æ ·ä¸€æ¥ï¼Œçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ï¼Œéƒ½ä½¿ç”¨ v-modle ç»‘å®šï¼ï¼Ÿï¼ï¼Ÿ



éœ€è¦æ¾„æ¸…è¿™ä¸ªé‡è¦æ¦‚å¿µï¼š

1. æ ¸å¿ƒåŒºåˆ«ï¼š**çˆ¶ç»„ä»¶ç”¨æŒ‡ä»¤ï¼Œå­ç»„ä»¶ç”¨å˜é‡**

```vue
<!-- çˆ¶ç»„ä»¶ï¼šä½¿ç”¨ v-model æŒ‡ä»¤ -->
<template>
  <ChildComponent v-model="parentData" />
  <!-- æˆ–è€…å¤šä¸ª v-model -->
  <ChildComponent 
    v-model:name="userName"
    v-model:age="userAge"
  />
</template>

<!-- å­ç»„ä»¶ï¼šä½¿ç”¨ defineModel() å˜é‡ -->
<script setup>
// æ¥æ”¶çˆ¶ç»„ä»¶çš„ v-model ç»‘å®š
const modelValue = defineModel()           // å¯¹åº” v-model
const name = defineModel('name')           // å¯¹åº” v-model:name
const age = defineModel('age', { type: Number })
</script>

<template>
  <!-- åœ¨å­ç»„ä»¶å†…éƒ¨ä½¿ç”¨å˜é‡ï¼Œä¸æ˜¯ v-model æŒ‡ä»¤ -->
  <input :value="name" @input="name = $event.target.value">
  
  <!-- æˆ–è€…ç›´æ¥ç”¨ v-modelï¼ˆè¿™æ˜¯å­ç»„ä»¶å†…éƒ¨çš„ v-modelï¼‰ -->
  <input v-model="age">
</template>
```

2. ä¸¤ä¸ªå±‚æ¬¡çš„ v-model

å±‚æ¬¡ä¸€ï¼šçˆ¶å­é€šä¿¡çš„ v-modelï¼ˆæŒ‡ä»¤ï¼‰

```vue
<!-- çˆ¶ç»„ä»¶ template ä¸­ -->
<ChildComponent v-model="data" />
<!-- è¿™æ˜¯ Vue æŒ‡ä»¤ï¼Œå»ºç«‹çˆ¶å­ç»‘å®š -->
```

å±‚æ¬¡äºŒï¼šå­ç»„ä»¶å†…éƒ¨çš„ v-modelï¼ˆå˜é‡/æŒ‡ä»¤ï¼‰

```vue
<!-- å­ç»„ä»¶å†…éƒ¨ -->
<script setup>
const data = defineModel()  // è¿™æ˜¯å˜é‡ï¼Œæ¥æ”¶çˆ¶ç»„ä»¶çš„ç»‘å®š
</script>

<template>
  <!-- è¿™æ˜¯å­ç»„ä»¶å†…éƒ¨è‡ªå·±ç”¨çš„ v-model æŒ‡ä»¤ -->
  <input v-model="data">  <!-- ç»‘å®šåˆ° defineModel() è¿”å›çš„å˜é‡ -->
</template>
```

3. å®Œæ•´æµç¨‹ç¤ºä¾‹ - åœºæ™¯ï¼šåŒå‘ç»‘å®šè¡¨å•

```vue
<!-- ParentComponent.vue -->
<template>
  <div>
    <p>çˆ¶ç»„ä»¶æ•°æ®ï¼š{{ formData.name }} - {{ formData.age }}</p>
    
    <!-- çˆ¶ç»„ä»¶ä½¿ç”¨ v-model æŒ‡ä»¤ç»‘å®šåˆ°å­ç»„ä»¶ -->
    <UserForm 
      v-model:name="formData.name"
      v-model:age="formData.age"
    />
  </div>
</template>

<script setup>
import { reactive } from 'vue'
import UserForm from './UserForm.vue'

// çˆ¶ç»„ä»¶çš„æ•°æ®
const formData = reactive({
  name: 'å¼ ä¸‰',
  age: 25
})
</script>

<!-- UserForm.vue å­ç»„ä»¶ -->
<script setup>
// å­ç»„ä»¶æ¥æ”¶çˆ¶ç»„ä»¶çš„ v-model ç»‘å®š
// è¿™é‡Œ defineModel() åˆ›å»ºçš„æ˜¯å“åº”å¼å˜é‡
const name = defineModel('name', { default: '' })
const age = defineModel('age', { type: Number, default: 0 })
</script>

<template>
  <div>
    <!-- å­ç»„ä»¶å†…éƒ¨å¯ä»¥åƒæ™®é€šå˜é‡ä¸€æ ·ä½¿ç”¨ -->
    <div>
      <label>å§“åï¼š</label>
      <!-- æ–¹å¼1ï¼šç›´æ¥ç»‘å®šåˆ°å˜é‡ -->
      <input :value="name" @input="name = $event.target.value">
    </div>
    
    <div>
      <label>å¹´é¾„ï¼š</label>
      <!-- æ–¹å¼2ï¼šä½¿ç”¨å­ç»„ä»¶å†…éƒ¨çš„ v-model æŒ‡ä»¤ -->
      <input v-model="age" type="number">
    </div>
    
    <!-- æ˜¾ç¤ºå­ç»„ä»¶å½“å‰çš„å€¼ -->
    <p>å­ç»„ä»¶å½“å‰å€¼ï¼š{{ name }} - {{ age }}</p>
  </div>
</template>
```



4. æ··æ·†ç‚¹ï¼šå­ç»„ä»¶æ¨¡æ¿ä¸­çš„ `v-model`

```vue
<!-- å­ç»„ä»¶ä¸­è¿™æ ·å†™ï¼š -->
<input v-model="name">

<!-- è¿™ä¸ª v-model æ˜¯ï¼š
1. ä¸€ä¸ª Vue æŒ‡ä»¤
2. ä½†å®ƒç»‘å®šçš„æ˜¯ defineModel() è¿”å›çš„å˜é‡
3. è¿™ä¸ªå˜é‡å·²ç»è¿æ¥äº†çˆ¶ç»„ä»¶
-->
```

å®é™…ä¸Šç›¸å½“äºï¼š

```vue
<!-- æ‰‹åŠ¨å®ç°çš„ç­‰ä»·ä»£ç  -->
<script setup>
// defineModel('name') ç›¸å½“äºï¼š
const props = defineProps(['name'])
const emit = defineEmits(['update:name'])

const name = computed({
  get() { return props.name },
  set(value) { emit('update:name', value) }
})
</script>

<template>
  <!-- è¿™æ ·å°±èƒ½ç†è§£ä¸ºä»€ä¹ˆå¯ä»¥ç”¨ v-model äº† -->
  <input v-model="name">
</template>
```



5. é”™è¯¯ç†è§£ vs æ­£ç¡®ç†è§£

âŒ **é”™è¯¯ç†è§£ï¼š**

```vue
<!-- çˆ¶ç»„ä»¶ -->
<ChildComponent v-model="data" />

<!-- å­ç»„ä»¶ï¼ˆé”™è¯¯ï¼ï¼‰ -->
<template>
  <!-- é”™è¯¯ï¼šåœ¨å­ç»„ä»¶ä¸­å¯¹çˆ¶ç»„ä»¶ç”¨ v-model -->
  <input v-model="parentData">
</template>
```



### âœ… **æ­£ç¡®ç†è§£ï¼š**

```vue
<!-- çˆ¶ç»„ä»¶ï¼šä½¿ç”¨æŒ‡ä»¤å»ºç«‹è¿æ¥ -->
<ChildComponent v-model="parentData" />

<!-- å­ç»„ä»¶ï¼šä½¿ç”¨å˜é‡æ¥æ”¶è¿æ¥ -->
<script setup>
const modelValue = defineModel()  // æ¥æ”¶è¿æ¥
</script>

<template>
  <!-- å†…éƒ¨å¯ä»¥ç”¨ v-model ç»‘å®šè¿™ä¸ªå˜é‡ -->
  <input v-model="modelValue">
  
  <!-- æˆ–è€…æ‰‹åŠ¨ç»‘å®š -->
  <input 
    :value="modelValue"
    @input="modelValue = $event.target.value"
  >
</template>
```

:::



## 3. Ref / æ¨¡æ¿å¼•ç”¨ï¼šç›´æ¥æ“ä½œç»„ä»¶

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦è°ƒç”¨å­ç»„ä»¶æ–¹æ³•ï¼ˆå¦‚å¼¹çª—æ‰“å¼€ï¼‰ã€èšç„¦è¾“å…¥æ¡†ã€æ“ä½œåŸç”Ÿå…ƒç´ ï¼ˆå¦‚ video æ’­æ”¾ï¼‰ã€‚

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

```vue
<!-- çˆ¶ç»„ä»¶ Parent.vue -->
<scriptÂ setup>
importÂ { ref, onMounted, nextTick }Â fromÂ 'vue'

// åˆ›å»º - å¼¹å‡ºå±‚å¼•ç”¨
const popupRef = ref<InstanceType<typeof BottomPopup> | null>(null)

// åœ¨é¡µé¢ä¸­ç›´æ¥ä½¿ç”¨onPageScrollç”Ÿå‘½å‘¨æœŸ
onPageScroll(e => {
  const scrollTopRpx = e.scrollTop / 2
  normalizedScrollTop.value = Math.min(100, Math.round(scrollTopRpx))
  if (normalizedScrollTop.value > 30) {
    ifScroll.value = true
  } else {
    ifScroll.value = false
  }
  console.log('ğŸ¯ æ ‡å‡†åŒ–æ»šåŠ¨å€¼:', normalizedScrollTop.value)
  console.log('ğŸ¯ æ»šåŠ¨è§¦å‘å¸ƒå°”å€¼å˜åŒ–:', ifScroll.value)
  popupRef.value?.resetInitialHeight()
  // popupRef.value?.close()
})
</script>

<tempalate>
	<!-- å¼¹å‡ºå±‚ç»„ä»¶ -->
    <BottomPopup
      ref="popupRef" <!-- è¿™é‡Œï¼Œä½¿ç”¨ ref è¿›è¡Œç»‘å®š -->
      v-model="popupVisible" 
      :default-height="80"
      :initial-height="100"
      active-height="85vh"
      @open="handleOpen"  
      @close="handleClose"  
    >
      <!-- ä½¿ç”¨æ’æ§½ä¼ å…¥è‡ªå®šä¹‰å†…å®¹ -->
    
    </BottomPopup>
</tempalate>
```

```vue
<!-- å­ç»„ä»¶ -->
<script>
 // === æ–°å¢ï¼šé‡ç½®åˆå§‹é«˜åº¦ ===
const resetInitialHeight = () => {
  // å¦‚æœå·²ç»é‡ç½®è¿‡ï¼Œæˆ–è€…æ²¡æœ‰åœ¨ä½¿ç”¨åˆå§‹é«˜åº¦ï¼Œç›´æ¥è¿”å›
  if (hasInitialHeightReset.value || !isUsingInitialHeight.value) return

  console.log('é‡ç½®å¼¹å‡ºå±‚åˆå§‹é«˜åº¦')
  hasInitialHeightReset.value = true
  isUsingInitialHeight.value = false

  // è§¦å‘å½’ä½äº‹ä»¶
  emit('initial-height-reset')

  // æ³¨æ„ï¼šè¿™é‡Œä¸éœ€è¦æ‰‹åŠ¨æ¸…ç†äº‹ä»¶ç›‘å¬
  // å› ä¸ºä½¿ç”¨çš„æ˜¯ { once: true } é€‰é¡¹ï¼Œäº‹ä»¶è§¦å‘åä¼šè‡ªåŠ¨ç§»é™¤
}
  
// æš´éœ²æ–¹æ³•ç»™çˆ¶ç»„ä»¶
defineExpose({
  open: () => togglePopup(true),
  close: () => togglePopup(false),
  toggle: () => togglePopup(),
  isActive,
  scrollToTop: () => {
    if (scrollViewRef.value) {
      scrollViewRef.value.scrollTo({
        top: 0,
        duration: 300,
      })
    }
  },
  // === æ–°å¢ï¼šæ‰‹åŠ¨é‡ç½®åˆå§‹é«˜åº¦ ===
  resetInitialHeight: () => {
    resetInitialHeight()
  },
  // === æ–°å¢ï¼šè·å–å½“å‰æ˜¯å¦åœ¨ä½¿ç”¨åˆå§‹é«˜åº¦ ===
  getIsUsingInitialHeight: () => isUsingInitialHeight.value,
})
</script>
```

:::



## 2. Provide / Injectï¼šè·¨å±‚çº§æ•°æ®ä¼ é€’

è§£å†³"prop é€çº§ä¼ é€’"é—®é¢˜ï¼Œå®ç°ç¥–å…ˆä¸åä»£ç»„ä»¶çš„ç›´æ¥é€šä¿¡ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šå½“æ•°æ®éœ€è¦ä»é¡¶å±‚ç»„ä»¶ä¼ é€’åˆ°åº•å±‚ç»„ä»¶ï¼Œä¸­é—´éš”äº†å¥½å‡ å±‚ï¼ˆæ¯”å¦‚ä¸»é¢˜ã€ç”¨æˆ·ä¿¡æ¯ã€è¯­è¨€è®¾ç½®ï¼‰ã€‚

::: details ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

```vue
<!-- æ ¹ç»„ä»¶ App.vue -->
<template>
Â  <divÂ id="app">
Â  Â  <HeaderÂ />
Â  Â  <divÂ class="main-content">
Â  Â  Â  <SidebarÂ />
Â  Â  Â  <ContentAreaÂ />
Â  Â  </div>
Â  Â  <FooterÂ />
Â  </div>
</template>

<scriptÂ setup>
importÂ { provide, ref, reactive, computed }Â fromÂ 'vue'

// æä¾›ç”¨æˆ·ä¿¡æ¯
constÂ currentUser =Â ref({
Â  id:Â 1,
Â  name:Â 'å¼ ä¸‰',
Â  role:Â 'admin',
Â  permissions: ['read',Â 'write',Â 'delete']
})

// æä¾›åº”ç”¨é…ç½®
constÂ appConfig =Â reactive({
Â  theme:Â 'dark',
Â  language:Â 'zh-CN',
Â  apiBaseUrl:Â import.meta.env.VITE_API_URL
})

// æä¾›æ–¹æ³•
constÂ updateUserÂ = (newUserData) => {
Â  currentUser.valueÂ = { ...currentUser.value, ...newUserData }
}

constÂ updateConfigÂ = (key, value) => {
Â  appConfig[key] = value
}

// è®¡ç®—å±æ€§
constÂ userPermissions =Â computed(() =>Â currentUser.value.permissions)

// æä¾›æ•°æ®å’Œæ–¹æ³•
provide('currentUser', currentUser)
provide('appConfig', appConfig)
provide('updateUser', updateUser)
provide('updateConfig', updateConfig)
provide('userPermissions', userPermissions)
</script>
```

```vue
<!-- æ·±å±‚åµŒå¥—çš„ç»„ä»¶ ContentArea.vue -->
<template>
Â  <divÂ class="content-area">
Â  Â  <UserProfileÂ />
Â  Â  <ArticleListÂ />
Â  </div>
</template>

<scriptÂ setup>
// è¿™ä¸ªç»„ä»¶ä¸éœ€è¦å¤„ç† propsï¼Œç›´æ¥æ¸²æŸ“å­ç»„ä»¶
</script>
```

```vue
<!-- ä½¿ç”¨æ³¨å…¥çš„ç»„ä»¶ UserProfile.vue -->
<template>
Â  <divÂ class="user-profile">
Â  Â  <h3>ç”¨æˆ·ä¿¡æ¯</h3>
Â  Â  <divÂ class="profile-card">
Â  Â  Â  <p>å§“åï¼š{{ currentUser.name }}</p>
Â  Â  Â  <p>è§’è‰²ï¼š{{ currentUser.role }}</p>
Â  Â  Â  <p>æƒé™ï¼š{{ userPermissions.join(', ') }}</p>
Â  Â  Â  <p>ä¸»é¢˜ï¼š{{ appConfig.theme }}</p>
Â  Â  </div>
Â  Â  <buttonÂ @click="handleUpdateProfile">æ›´æ–°èµ„æ–™</button>
Â  </div>
</template>

<scriptÂ setup>
importÂ { inject }Â fromÂ 'vue'

// æ³¨å…¥æ•°æ®å’Œæ–¹æ³•
constÂ currentUser =Â inject('currentUser')
constÂ appConfig =Â inject('appConfig')
constÂ userPermissions =Â inject('userPermissions')
constÂ updateUser =Â inject('updateUser')

constÂ handleUpdateProfileÂ = () => {
Â  updateUser({
Â  Â  name:Â 'æå››',
Â  Â  role:Â 'user'
Â  })
}
</script>
```

**Provide/Injectçš„ä¼˜åŠ¿**ï¼š

- é¿å…Propsé€å±‚ä¼ é€’çš„ç¹ç
- å®ç°è·¨å±‚çº§ç»„ä»¶é€šä¿¡
- æä¾›å…¨å±€çŠ¶æ€å’Œæ–¹æ³•çš„ç»Ÿä¸€ç®¡ç†
- æé«˜ä»£ç çš„å¯ç»´æŠ¤æ€§

:::



##5. Piniaï¼šç°ä»£åŒ–çŠ¶æ€ç®¡ç†

å¯¹äºå¤æ‚åº”ç”¨ï¼ŒPinia æä¾›äº†æ›´ä¼˜ç§€çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆã€‚